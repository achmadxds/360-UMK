<!DOCTYPE html>
<html lang="en">

<head>
	<!--projecttitle-->
	<title>360 View</title>
	<!--projecttitle-end-->
	<!--projectdescription-->
	<meta name="description" content="New 3Sixty Virtual Tour Project">
	<!--projectdescription-end-->
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<meta charset="utf-8">
	<meta name="viewport"
		content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width, shrink-to-fit=no">

	<link rel="stylesheet" type="text/css" href="css/font-awesome.css">
	<link rel="stylesheet" type="text/css" href="style.css">

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
	<!-- JavaScript Bundle with Popper -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
		crossorigin="anonymous"></script>

	<!-- Insert this line above script imports  -->
	<script>if (typeof module === 'object') { window.module = module; module = undefined; }</script>

	<script src="imagedata.js"></script>
	<script src="jquery.js"></script>
	<script src="three.min.js"></script>
	<script src="panolens.min.js"></script>

	<!-- Insert this line after script imports -->
	<script>if (window.module) module = window.module;</script>

	<style>
		@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@200;300;400;500;600;700&display=swap');

		/* SCROLLBAR STYLING */
		/* width */
		::-webkit-scrollbar {
			width: 0.25em;
			height: 0.25em;
		}

		/* Track */
		::-webkit-scrollbar-track {
			background: #2c3643;
		}

		/* Handle */
		::-webkit-scrollbar-thumb {
			background: #0d9e59;
			transition: background .5s;
		}

		/* Handle on hover */
		::-webkit-scrollbar-thumb:hover {
			background: #00e075;
		}


		html,
		body {
			margin: 0;
			width: 100%;
			height: 100%;
			overflow: hidden;
			background-color: #000;
			color;
			black;
		}

		a:link,
		a:visited {
			color: #ffff;
		}

		.fullwrapper {
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background-color: black;
		}

		#container {
			width: 100%;
			height: 100%;
		}

		#tmp {
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			padding: 3em;
			background-color: rgba(0, 0, 0, .5);
			backdrop-filter: blur(5px);
			display: none;
		}

		.nav-item {
			font-weight: 600;
			margin-right: 30px;
			font-size: 20px;
			font-family: 'Poppins', sans-serif;
		}

		.nav-item:hover {
			border: none;
		}

		.footer {
			position: fixed;
			left: 0;
			bottom: 0;
			width: 16%;
			background-color: transparent;
			color: white;
			text-align: center;
		}
	</style>
</head>

<body id="body">
	<nav class="navbar fixed-top navbar-expand-lg navbar-dark p-md-4">
		<div class="container-fluid">
			<a href="#" class="navbar-brand">
				<img src="images/logo_umk.png" height="60" alt="CoolBrand">
			</a>
			<button type="button" class="navbar-toggler" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse" id="navbarCollapse">
				<div class="navbar-nav ms-auto">
					<a href="#" class="nav-item nav-link btn btn-danger">Pengaturan</a>
					<a href="#" class="nav-item nav-link">Tentang</a>
					<a href="#" class="nav-item nav-link">Schollarship</a>
					<a href="#" class="nav-item nav-link">Perusahaan</a>
				</div>
			</div>
		</div>
	</nav>

	<!--customhtml-->
	<div class='customhotspot' id='depan'>
		<div onclick='chclickinfospotdepan0();' id='infospotdepan0'
			style='position: fixed; top: 0; left: 0; cursor: pointer;'><img src='customhotspots/umklogo.png'
				style='width: 64px; height: 64px;'></div>
		<div onclick='chclickinfospotdepan1();' id='infospotdepan1'
			style='position: fixed; top: 0; left: 0; cursor: pointer;'><img src='customhotspots/umklogo.png'
				style='width: 64px; height: 64px;'></div>
	</div>
	<div class='customhotspot' id='perpus'>
		<div onclick='chclickinfospotperpus0();' id='infospotperpus0'
			style='position: fixed; top: 0; left: 0; cursor: pointer;'><img src='customhotspots/umklogo.png'
				style='width: 64px; height: 64px;'></div>
		<div onclick='chclickinfospotperpus1();' id='infospotperpus1'
			style='position: fixed; top: 0; left: 0; cursor: pointer;'><img src='customhotspots/umklogo.png'
				style='width: 64px; height: 64px;'></div>
	</div>
	<div class='customhotspot' id='masjid'></div>
	<!--customhtml-end-->

	<div id="tmp">
		<center>
			<div
				style="width: 100%; height: 100%; overflow: hidden; overflow-y: auto; box-sizing: border-box; position: relative;"
				id="tmpcontent"></div>
		</center>
	</div>


	<div id="loading" class="fullwrapper" style="display: table; width: 100%; height: 100%;">
		<div
			style="display: table-cell; vertical-align: middle; text-align: center; color: white; font-size: 30px; padding: 50px;">
			<!--loadingtext-->Loading...
			<!--loadingtext-end-->
		</div>
	</div>

	<div class="footer">
		<div class="alert alert-secondary shadow" role="alert" id="textInfoDown">
			Halaman Depan
		</div>
	</div>

	<script>

		var container = document.querySelector('#container');
		/*panolens*/

		var viewer = new PANOLENS.Viewer({ container: container, controlBar: false, output: 'console', autoHideInfospot: false, });

		/*panolens-end*/

		viewer.addUpdateCallback(function () { });

		/*panoramas*/

		var depan = new PANOLENS.ImagePanorama("panoramas/depan.jpg");
		depan.addEventListener('progress', function (e) {
			$("#loading").show();
		});
		depan.addEventListener('load', function (e) {
			$("#loading").fadeOut();
		});
		depan.addEventListener('click', function (e) {
		});


		var infospotdepan0 = new PANOLENS.Infospot(512, hotspotIcons[0].data, true);
		infospotdepan0.position.set(3513.50, 141.22, -3540.04);
		infospotdepan0.visible = false;
		depan.add(infospotdepan0);

		infospotdepan0.addEventListener('click', function () {
			ChangePanorama('perpus');
			ChangePanorama('perpus');
			document.getElementById("textInfoDown").innerHTML = 'Gedung Perpustakaan';
		});

		var infospotdepan1 = new PANOLENS.Infospot(512, hotspotIcons[0].data, true);
		infospotdepan1.position.set(4980.84, 288.95, 148.93);
		infospotdepan1.visible = false;
		depan.add(infospotdepan1);

		infospotdepan1.addEventListener('click', function () {

			showMedia(1, 'images/5.png');

		});

		viewer.add(depan);

		var perpus = new PANOLENS.ImagePanorama("panoramas/perpus.jpg");
		perpus.addEventListener('progress', function (e) {
			$("#loading").show();
		});
		perpus.addEventListener('load', function (e) {
			$("#loading").fadeOut();
		});
		perpus.addEventListener('click', function (e) {
		});


		var infospotperpus0 = new PANOLENS.Infospot(512, hotspotIcons[0].data, true);
		infospotperpus0.position.set(3823.02, 344.82, -3191.65);
		infospotperpus0.visible = false;
		perpus.add(infospotperpus0);

		infospotperpus0.addEventListener('click', function () {
			ChangePanorama('masjid');
			document.getElementById("textInfoDown").innerHTML = 'Depan Gedung Perpustakaan2';
		});

		var infospotperpus1 = new PANOLENS.Infospot(512, hotspotIcons[0].data, true);
		infospotperpus1.position.set(-2370.13, 121.27, -4390.96);
		infospotperpus1.visible = false;
		perpus.add(infospotperpus1);

		infospotperpus1.addEventListener('click', function () {
			ChangePanorama('depan');
			document.getElementById("textInfoDown").innerHTML = 'Depan Gedung Perpustakaan1';
		});

		viewer.add(perpus);

		var masjid = new PANOLENS.ImagePanorama("panoramas/masjid.jpg");
		masjid.addEventListener('progress', function (e) {
			$("#loading").show();
		});
		masjid.addEventListener('load', function (e) {
			$("#loading").fadeOut();
		});
		masjid.addEventListener('click', function (e) {
		});


		viewer.add(masjid);

		$(document).ready(function () { ChangePanorama('depan'); });


		/*panoramas-end*/


		function hideTemp() {
			$("#tmp").fadeOut();
			setTimeout(function () {
				$("#tmpcontent").html("");
			}, 1000);
		}

		function showMedia(type, content) {
			switch (type) {
				case 1:
					//Image
					$("#tmpcontent").html("<img onclick='hideTemp()' class='mt-5 pt-3' src='" + content + "' style='width: 50%;'>");
					$("#tmp").fadeIn();
					break;
				case 2:
					//Video
					$("#tmpcontent").html("<video id='webvideo' controls autoplay style='width: 100%; height: 100%;'><source src='" + content + "' type='video/mp4'> Your browser does not support the video tag. </video>");
					$("#tmp").fadeIn();
					break;
				case 3:
					//Audio
					$("#tmpcontent").html("<audio controls style='width: 100%;'><source src='" + content + "' type='audio/ogg'>Your browser does not support the audio tag.</audio>");
					$("#tmp").fadeIn();
					break;
				case 4:
					//PDF
					$("#tmpcontent").html("<iframe src='pdfjs/web/viewer.html?file=../../" + content + "' style='width: 100%; height: 99%;'></iframe>");
					$("#tmp").fadeIn();
					break;
			}
		}



		//Update Callback
		viewer.addUpdateCallback(function () {

			/*viewerupdatecallback*/
			if (viewer.panorama == depan) {
				ShowMyInfospot(infospotdepan0, 'infospotdepan0');
				ShowMyInfospot(infospotdepan1, 'infospotdepan1');
			}

			if (viewer.panorama == perpus) {
				ShowMyInfospot(infospotperpus0, 'infospotperpus0');
				ShowMyInfospot(infospotperpus1, 'infospotperpus1');
			}

			if (viewer.panorama == masjid) {
			}
			/*viewerupdatecallback-end*/


		});



		var hotspotsvisible = true;
		function ShowMyInfospot(hs, elid) {
			var thehs = toScreenPosition(hs);
			if (thehs.z < 1) {
				$("#" + elid).css({
					"top": (thehs.y - ($("#" + elid).height() / 2)) + "px",
					"left": (thehs.x - ($("#" + elid).width() / 2)) + "px",
				});
				if (hotspotsvisible)
					$("#" + elid).show();
			} else {
				$("#" + elid).hide();
			}

		}

		function toScreenPosition(obj) {
			var vector = new THREE.Vector3();
			var widthHalf = 0.5 * innerWidth;
			var heightHalf = 0.5 * innerHeight;

			//obj.updateMatrixWorld();				
			vector.setFromMatrixPosition(obj.matrixWorld);


			vector.project(viewer.camera);

			vector.x = (vector.x * widthHalf) + widthHalf;
			vector.y = - (vector.y * heightHalf) + heightHalf;


			return {
				x: vector.x,
				y: vector.y,
				z: vector.z,
			};

		};

		var currentPanorama;
		function ChangePanorama(panorama) {
			currentPanorama = panorama;
			HideInfospots();
			//$("#loading").fadeIn();
			//$(".customhotspot").fadeOut();
			setTimeout(function () {
				viewer.setPanorama(window[panorama]);
			}, 500);
			setTimeout(function () {
				$("#" + panorama).fadeIn();
			}, 1500);

		}

		function HideInfospots() {
			$(".customhotspot").fadeOut();
		}

		/*customjs*/
		function chclickinfospotdepan0() {
			document.getElementById("textInfoDown").innerHTML = 'Depan Gedung Perpustakaan';
			ChangePanorama('perpus');
			ChangePanorama('perpus');
		}

		function chclickinfospotdepan1() {
			showMedia(1, 'images/5.png');

		}

		function chclickinfospotperpus0() {
			ChangePanorama('masjid');
			document.getElementById("textInfoDown").innerHTML = 'Depan Masjid';
		}

		function chclickinfospotperpus1() {
			document.getElementById("textInfoDown").innerHTML = 'Halaman Depan';
			ChangePanorama('depan');
		}
/*customjs-end*/
	</script>
</body>

</html>